# 多角度相机交互优化完成

## 优化概述
将抽象的立方体替换为直观的人物模型，并添加拖拽旋转、滚轮缩放等交互功能，让用户可以更直观地预览相机位置和拍摄效果。

## 主要改进

### 1. 人物模型替代立方体 👤

#### 之前：抽象的立方体
```
┌─────┐
│  ▓  │  ← 看不出是什么
└─────┘
```

#### 现在：直观的人物模型
```
    ●      ← 头部（圆形，肤色）
   ╱│╲     ← 身体（蓝色衣服）
  ╱ │ ╲    ← 手臂
   ╱ ╲     ← 腿部（深色裤子）
```

**人物模型组成**：
- **头部**：12×12px 圆形，琥珀色渐变，带眼睛和嘴巴
- **身体**：16×24px 矩形，蓝色渐变，带衣服细节
- **手臂**：左右各 4×20px，蓝色，略微倾斜
- **腿部**：左右各 5×24px，深灰色

**3D 定位**：
- 头部：translateZ(20px) translateY(-140px)
- 身体：translateZ(15px) translateY(-100px)
- 手臂：translateZ(10px) translateY(-95px)
- 腿部：translateZ(12px) translateY(-76px)

### 2. 拖拽旋转功能 🖱️

#### 实现方式
```typescript
const handleSceneMouseDown = (e: React.MouseEvent) => {
  e.stopPropagation();
  setIsDragging(true);
  setDragStart({ x: e.clientX, y: e.clientY, h: horizontalAngle, v: verticalAngle });
};

const handleSceneMouseMove = (e: MouseEvent) => {
  if (!isDragging) return;
  const deltaX = e.clientX - dragStart.x;
  const deltaY = e.clientY - dragStart.y;
  
  // 水平拖动控制水平角度
  const newH = (dragStart.h + deltaX * 0.5) % 360;
  onHorizontalAngleChange(newH < 0 ? newH + 360 : newH);
  
  // 垂直拖动控制垂直角度
  const newV = Math.max(-30, Math.min(60, dragStart.v - deltaY * 0.3));
  onVerticalAngleChange(newV);
};
```

#### 交互说明
- **左右拖动**：旋转水平角度（0° - 360°）
- **上下拖动**：旋转垂直角度（-30° - 60°）
- **灵敏度**：水平 0.5x，垂直 0.3x（更精确）
- **光标变化**：`cursor-grab` → `active:cursor-grabbing`

### 3. 滚轮缩放功能 🔍

#### 实现方式
```typescript
onWheel={(e) => {
  e.stopPropagation();
  const delta = e.deltaY > 0 ? 0.5 : -0.5;
  const newZoom = Math.max(0, Math.min(10, cameraZoom + delta));
  onZoomChange(newZoom);
}}
```

#### 交互说明
- **向上滚动**：相机拉近（zoom - 0.5）
- **向下滚动**：相机拉远（zoom + 0.5）
- **范围限制**：0 - 10
- **阻止冒泡**：不影响画布缩放

### 4. 相机取景框 📷

#### 新增元素
```typescript
{/* 拍摄框 - 模拟相机取景 */}
<div style={{
  width: '80px',
  height: '60px',
  transform: 'translate(-50%, -50%) translateZ(-30px)',
  border: '2px solid rgba(168, 85, 247, 0.6)',
}}>
  {/* 取景框角标 */}
  <div className="absolute top-0 left-0 w-3 h-3 border-t-2 border-l-2" />
  <div className="absolute top-0 right-0 w-3 h-3 border-t-2 border-r-2" />
  <div className="absolute bottom-0 left-0 w-3 h-3 border-b-2 border-l-2" />
  <div className="absolute bottom-0 right-0 w-3 h-3 border-b-2 border-r-2" />
  
  {/* 中心十字 */}
  <div className="absolute top-1/2 left-1/2 w-4 h-px bg-purple-400/60" />
  <div className="absolute top-1/2 left-1/2 w-px h-4 bg-purple-400/60" />
</div>
```

#### 视觉效果
- **尺寸**：80×60px（16:9 比例）
- **位置**：相机前方 30px
- **边框**：紫色发光边框
- **角标**：四个角的 L 形标记
- **十字**：中心对焦十字线

### 5. 相机预览窗口 🎬

#### 新增功能
```typescript
{/* 相机预览窗口 */}
<div className="w-24 h-16 bg-black/60 border border-purple-500/30 rounded-lg">
  <div className="flex items-center justify-center">
    <Camera size={16} />
    <div>预览</div>
  </div>
  {/* 取景框角标 */}
  <div className="absolute top-1 left-1 w-2 h-2 border-t border-l" />
  {/* ... 其他角标 */}
</div>
```

#### 位置和功能
- **位置**：标题栏右侧
- **尺寸**：24×16px
- **功能**：显示相机视角预览（未来可以渲染实际画面）
- **Hover**：显示"相机视角预览"提示

### 6. 实时参数显示 📊

#### 新增显示
```typescript
<div className="flex items-center justify-center gap-4 text-xs text-slate-500">
  <div className="flex items-center gap-1">
    <span className="text-purple-400">H:</span>
    <span className="font-mono">{Math.round(horizontalAngle)}°</span>
  </div>
  <div className="flex items-center gap-1">
    <span className="text-cyan-400">V:</span>
    <span className="font-mono">{Math.round(verticalAngle)}°</span>
  </div>
  <div className="flex items-center gap-1">
    <span className="text-pink-400">Z:</span>
    <span className="font-mono">{cameraZoom.toFixed(1)}</span>
  </div>
</div>
```

#### 显示内容
- **H（水平）**：紫色，显示当前水平角度
- **V（垂直）**：青色，显示当前垂直角度
- **Z（距离）**：粉色，显示当前缩放值
- **字体**：等宽字体，更专业

### 7. 拖拽提示 💡

#### 新增提示
```typescript
<div className="absolute top-4 left-1/2 -translate-x-1/2 px-3 py-1.5 
     bg-black/60 backdrop-blur-sm rounded-lg border border-purple-500/30 z-10">
  <span className="text-xs text-purple-300">🖱️ 拖拽旋转 · 滚轮缩放</span>
</div>
```

#### 位置和样式
- **位置**：3D 场景顶部中央
- **背景**：半透明黑色 + 毛玻璃效果
- **边框**：紫色发光边框
- **图标**：鼠标图标 + 文字说明

## 交互流程

### 场景 1：调整水平角度
```
1. 用户在 3D 场景上按下鼠标左键
2. 光标变为 "grabbing"（抓取状态）
3. 左右拖动鼠标
4. 人物模型实时旋转（水平）
5. 相机位置同步更新
6. 参数显示实时更新（H: 45°）
7. 释放鼠标，完成调整
```

### 场景 2：调整垂直角度
```
1. 用户在 3D 场景上按下鼠标左键
2. 上下拖动鼠标
3. 整个场景实时倾斜（垂直）
4. 相机位置同步更新
5. 参数显示实时更新（V: 30°）
6. 释放鼠标，完成调整
```

### 场景 3：调整相机距离
```
1. 用户在 3D 场景上滚动鼠标滚轮
2. 向上滚动 → 相机拉近
3. 向下滚动 → 相机拉远
4. 相机位置实时移动
5. 参数显示实时更新（Z: 7.5）
```

### 场景 4：使用预设
```
1. 用户点击"正面"预设
2. 水平角度自动设置为 0°
3. 场景平滑过渡（700ms）
4. 参数显示更新
5. 相机位置更新
```

## 视觉对比

### 之前：抽象立方体
```
┌─────────────────────────────┐
│                             │
│       ┌─────┐               │
│       │  ▓  │  ← 立方体     │
│       └─────┘               │
│                             │
│   ❓ 看不出是什么            │
│   ❓ 不知道哪个是正面        │
│   ❓ 没有参考物              │
└─────────────────────────────┘
```

### 现在：人物模型
```
┌─────────────────────────────┐
│  🖱️ 拖拽旋转 · 滚轮缩放      │
│                             │
│         ●                   │
│        ╱│╲    ← 人物        │
│       ╱ │ ╲                 │
│        ╱ ╲                  │
│                             │
│   ✅ 一眼看出是人物          │
│   ✅ 清楚知道正面在哪        │
│   ✅ 有明确的参考            │
│                             │
│   H: 45° · V: 15° · Z: 5.0  │
└─────────────────────────────┘
```

## 技术细节

### 人物模型 3D 结构
```typescript
// 头部（最前面）
translateZ(20px) translateY(-140px)

// 身体（中间）
translateZ(15px) translateY(-100px)

// 手臂（稍后）
translateZ(10px) translateY(-95px)

// 腿部（中间）
translateZ(12px) translateY(-76px)
```

### 拖拽灵敏度调整
```typescript
// 水平：0.5x（更平滑）
const newH = dragStart.h + deltaX * 0.5;

// 垂直：0.3x（更精确）
const newV = dragStart.v - deltaY * 0.3;
```

### 滚轮步进值
```typescript
// 每次滚动 ±0.5
const delta = e.deltaY > 0 ? 0.5 : -0.5;
```

## 性能优化

### 1. 事件处理优化
```typescript
// 阻止事件冒泡
e.stopPropagation();

// 只在拖拽时监听 mousemove
useEffect(() => {
  if (isDragging) {
    window.addEventListener('mousemove', handleSceneMouseMove);
    window.addEventListener('mouseup', handleSceneMouseUp);
    return () => {
      window.removeEventListener('mousemove', handleSceneMouseMove);
      window.removeEventListener('mouseup', handleSceneMouseUp);
    };
  }
}, [isDragging, dragStart]);
```

### 2. 平滑过渡
```css
transition: transform 0.7s ease-out;
```

### 3. GPU 加速
```css
transform: translateZ(0);
transform-style: preserve-3d;
```

## 用户体验提升

### 之前的问题
1. ❌ 立方体太抽象，看不懂
2. ❌ 只能用滑块调整，不直观
3. ❌ 不知道相机在拍什么
4. ❌ 没有实时参数显示
5. ❌ 缺少交互反馈

### 现在的改进
1. ✅ 人物模型直观易懂
2. ✅ 可以直接拖拽旋转
3. ✅ 有取景框显示拍摄范围
4. ✅ 实时显示 H/V/Z 参数
5. ✅ 光标变化、提示文字等反馈

## 未来扩展

### 1. 相机预览渲染
```typescript
// 在预览窗口中渲染实际画面
<canvas ref={previewCanvasRef} width={96} height={64} />
```

### 2. 多个人物/道具
```typescript
// 添加更多对象
<PersonModel position={[-100, 0, 0]} />
<PropModel position={[100, 0, 0]} />
```

### 3. 光照效果
```typescript
// 模拟光源
<Light position={[200, 200, 200]} />
```

### 4. 相机路径动画
```typescript
// 预设相机运动路径
const cameraPath = [
  { h: 0, v: 0, z: 5, duration: 1000 },
  { h: 90, v: 15, z: 7, duration: 1000 },
  // ...
];
```

## 总结

### 主要成果
- ✅ 人物模型替代抽象立方体
- ✅ 拖拽旋转功能
- ✅ 滚轮缩放功能
- ✅ 相机取景框
- ✅ 相机预览窗口
- ✅ 实时参数显示
- ✅ 拖拽提示

### 用户反馈预期
- 😊 "终于看懂了！原来是拍人物的！"
- 😊 "拖拽旋转太方便了，比滑块好用多了！"
- 😊 "取景框很专业，知道相机在拍什么了！"
- 😊 "实时参数显示很清楚！"
- 😊 "整体交互体验提升很大！"

### 技术亮点
- 🎨 纯 CSS 3D，无需 Three.js
- ⚡ 性能优异，流畅交互
- 🎯 精确的拖拽控制
- 📐 专业的取景框设计
- 🔧 代码简洁，易于扩展
